<html>
  <body>
    <center>
      <p>
        <h3>Below is the 10 bit PNG image with Linear gamma profile
        <a
          href="https://github.com/ellelstone/elles_icc_profiles/blob/master/profiles/Rec2020-elle-V4-g10.icc"
          >Rec2020-elle-V4-g10.icc</a
        ></h3>
        <br />
        The below image has 16 stripes [ 4 of each color ] that consists of alternating 
        pixels with values A and B(dithered stripe). Next to each of them we have another 
        16 stripes in which all the pixels are set to (A+B)/2(solid stripe). Since the 
        image is linear, the optically averaged dithered stripe is physically
        identical to the solid stripe. if there is any nonlinearity then, most
        likely, the two stripes would have been physically different and the
        difference would have been apparent as a difference in brightness.
      </p>
    
    <img id="image" src="image.png" height="540" />
    <p id="message0"></p>
    <h3><p id="message1"></p></h3>
    <video id="output-video" controls autoplay height="540"></video>
    <p id="message2"></p>
    </center>
    <script>
      const message0 = document.getElementById("message0");
      const message1 = document.getElementById("message1");
      const video = document.getElementById("output-video");
      const message2 = document.getElementById("message2");

      const isHVC1Supported = MediaSource.isTypeSupported(
        'video/mp4; codecs="hvc1"'
      );
      const isAVC1Supported = MediaSource.isTypeSupported(
        'video/mp4; codecs="avc1.6e0033"'
      );
      if (isHVC1Supported == true) {
        //safari video
        message0.innerHTML = "HVC1 codecs is supported by the browser (Checked using MediaSource.isTypeSupported)"
        message1.innerHTML =
          "Below is the HDR video generated from this image using H.265 Codecs with <a target='_blank' href='https://github.com/ffmpegwasm/ffmpeg.wasm'>ffmpeg.wasm</a>";
        video.src = "safari_video.mp4";
        var msg =
          "hvc1 compiled using <b><u>libx265</b></u> codecs with <b><u>yuv420p10le</u></b> pixel format, <br>";
        msg +=
          "color_range=pc, colorprim=bt2020, transfer=smpte2084, colormatrix=bt2020nc";
        msg += "<br> Currently it seems the video generated with H.265 codecs is changing the color profile of the video while conversion. "
        msg += "<br>Please try using Chrome for now as the codecs H.264 which is generating correct video is not playable in Safari."
        message2.innerHTML = msg;
        console.log(msg);
      } else if (isAVC1Supported == true) {
        //chrome video
        message0.innerHTML = "HVC1 codecs is not supported by the browser, so using AVC1 (Checked using MediaSource.isTypeSupported)"
        message1.innerHTML =
          "Below is the HDR video generated from this image using H.264 Codecs with <a target='_blank' href='https://github.com/ffmpegwasm/ffmpeg.wasm'>ffmpeg.wasm</a>";
        video.src = "chrome_video.mp4";
        var msg =
          "avc1 compiled using <b><u>libx264</b></u> codecs with <b><u>yuv420p10le</u></b> pixel format, <br>";
        msg +=
          "color_range=pc, colorprim=bt2020, transfer=smpte2084, colormatrix=bt2020nc";
        message2.innerHTML = msg;
        console.log(msg);
      } else {
        message1.innerHTML =
          "Both hvc1 and avc1.6e0033 codecs not supported by your browser. Please use CHROME or SAFARI";
      }
    </script>
  </body>
</html>
